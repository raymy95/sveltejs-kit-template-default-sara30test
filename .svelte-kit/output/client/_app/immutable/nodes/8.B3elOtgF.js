import"../chunks/NZTpNUN0.js";import"../chunks/BBjpR9ww.js";import{p as ea,l as ta,a2 as sa,ac as p,aa as s,g as r,af as C,ab as e,c as w,a9 as F,w as ra}from"../chunks/B7pVfImq.js";import{s as u}from"../chunks/C49klihd.js";import{i as j,s as oa,a as la}from"../chunks/C_PPKRUY.js";import{e as va,i as na}from"../chunks/BWaKuXpU.js";import{t as i,h as ia,a as n}from"../chunks/C7ddXOl0.js";import{s as da}from"../chunks/C3auQ9ac.js";import{i as ca}from"../chunks/DcBDN0ri.js";import{o as fa}from"../chunks/BHCZFSv4.js";import{a as I,s as ha}from"../chunks/C2mqf3jC.js";const pa=!1;async function ua({parent:k}){return await k(),{}}const Fa=Object.freeze(Object.defineProperty({__proto__:null,load:ua,prerender:pa},Symbol.toStringTag,{value:"Module"}));var ma=i('<meta name="description" content="User rankings">'),_a=i('<div class="loading svelte-1qv5khf"><p>Loading rankings...</p></div>'),ka=i('<div class="error svelte-1qv5khf"><p> </p></div>'),ga=i('<div class="no-data svelte-1qv5khf"><p>No rankings available yet.</p></div>'),qa=i('<tr><td class="svelte-1qv5khf"> </td><td class="svelte-1qv5khf"> </td><td class="svelte-1qv5khf"> </td><td class="svelte-1qv5khf"> </td></tr>'),ba=i('<div class="rankings svelte-1qv5khf"><table class="svelte-1qv5khf"><thead><tr><th class="svelte-1qv5khf">Rank</th><th class="svelte-1qv5khf">Username</th><th class="svelte-1qv5khf">Score</th><th class="svelte-1qv5khf">Cards Unlocked</th></tr></thead><tbody></tbody></table></div>'),ya=i('<div class="container svelte-1qv5khf"><h1 class="svelte-1qv5khf">Classement</h1> <!></div>');function Ia(k,L){ea(L,!1);const[N,P]=oa(),T=()=>la(I,"$auth",N);let g=C([]),z=C(!0),q=C(null);async function A(){try{const{data:a,error:o}=await ha.from("users").select(`
                    id,
                    username,
                    user_cards (score)
                `);if(o)throw o;w(g,a.map(t=>({id:t.id,username:t.username,totalScore:t.user_cards.reduce((v,l)=>v+(l.score||0),0),cardsUnlocked:t.user_cards.length})).sort((t,v)=>v.totalScore-t.totalScore).map((t,v)=>({...t,rank:v+1})))}catch(a){console.error("Error loading rankings:",a),w(q,"Failed to load rankings")}finally{w(z,!1)}}fa(()=>{I.initialize(),A()}),ca();var b=ya();ia(a=>{var o=ma();sa.title="Classement - Card Collection",n(a,o)});var B=p(s(b),2);{var D=a=>{var o=_a();n(a,o)},G=(a,o)=>{{var t=l=>{var c=ka(),m=s(c),y=s(m,!0);e(m),e(c),F(()=>u(y,r(q))),n(l,c)},v=(l,c)=>{{var m=d=>{var f=ga();n(d,f)},y=d=>{var f=ba(),E=s(f),M=p(s(E));va(M,5,()=>r(g),na,(H,h)=>{let J=()=>r(h).rank,K=()=>r(h).username,Q=()=>r(h).totalScore,V=()=>r(h).cardsUnlocked,W=()=>r(h).id;var _=qa();let O;var x=s(_),X=s(x,!0);e(x);var S=p(x),Y=s(S,!0);e(S);var U=p(S),Z=s(U,!0);e(U);var R=p(U),$=s(R,!0);e(R),e(_),F(aa=>{O=da(_,1,"svelte-1qv5khf",null,O,aa),u(X,J()),u(Y,K()),u(Z,Q()),u($,V())},[()=>({"current-user":W()===T().userId})],ra),n(H,_)}),e(M),e(E),e(f),n(d,f)};j(l,d=>{r(g).length===0?d(m):d(y,!1)},c)}};j(a,l=>{r(q)?l(t):l(v,!1)},o)}};j(B,a=>{r(z)?a(D):a(G,!1)})}e(b),n(k,b),ta(),P()}export{Ia as component,Fa as universal};
